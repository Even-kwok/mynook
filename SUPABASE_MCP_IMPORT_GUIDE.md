# ğŸ“š Supabase MCP æ¨¡æ¿å¯¼å…¥æŒ‡å— (æ–¹æ¡ˆB)

**åˆ›å»ºæ—¥æœŸ:** 2025-10-12  
**çŠ¶æ€:** âœ… å°±ç»ªå¾…æ‰§è¡Œ  
**æ–¹æ³•:** é€šè¿‡ç¼–ç¨‹æ–¹å¼ä½¿ç”¨ Supabase å®¢æˆ·ç«¯ (MCP é£æ ¼)

---

## ğŸ¯ æ¦‚è¿°

æ­¤æ–¹æ¡ˆä½¿ç”¨é¡¹ç›®çš„ Supabase å®¢æˆ·ç«¯é…ç½®ï¼Œé€šè¿‡ç¼–ç¨‹æ–¹å¼æ‰¹é‡å¯¼å…¥æ¨¡æ¿æ•°æ®åˆ°æ•°æ®åº“ã€‚è¿™æ˜¯ MCP (Model Context Protocol) ç†å¿µçš„å®ç° - é€šè¿‡ä»£ç ç›´æ¥ä¸æ•°æ®åº“äº¤äº’ã€‚

**ç”Ÿæˆçš„æ¨¡æ¿æ•°é‡:** 31 ä¸ª
**åŒ…å«æˆ¿é—´ç±»å‹:** 5 ç§ (Living Room, Master Bedroom, Kitchen, Bathroom, Home Office)
**åŒ…å«è®¾è®¡é£æ ¼:** 10 ç§é«˜ä¼˜å…ˆçº§é£æ ¼

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

### å·²åˆ›å»ºçš„è„šæœ¬

1. **`scripts/supabase-mcp-import.js`** - ä¸»å¯¼å…¥è„šæœ¬ â­
   - å®Œæ•´çš„æ¨¡æ¿ç”Ÿæˆå’Œå¯¼å…¥é€»è¾‘
   - æ‰¹é‡å¤„ç† (æ¯æ‰¹ 10 ä¸ªæ¨¡æ¿)
   - é”™è¯¯å¤„ç†å’Œè¿›åº¦è·Ÿè¸ª
   - å¯¼å…¥éªŒè¯

2. **`scripts/generate-import-sql.js`** - SQL ç”Ÿæˆè„šæœ¬
   - ç”Ÿæˆ SQL INSERT è¯­å¥
   - å¯é€‰æ–¹æ¡ˆï¼šæ‰‹åŠ¨æ‰§è¡Œ SQL

3. **`scripts/import-templates.sql`** - ç”Ÿæˆçš„ SQL æ–‡ä»¶
   - åŒ…å« 31 ä¸ªæ¨¡æ¿çš„ INSERT è¯­å¥
   - å¯ç›´æ¥åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ

---

## ğŸš€ æ‰§è¡Œæ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨ Node.js è„šæœ¬æ‰§è¡Œ (æ¨è) â­

#### æ­¥éª¤ 1: è·å– Supabase å‡­è¯

æ‚¨éœ€è¦ä» Vercel æˆ– Supabase Dashboard è·å–ï¼š
- `SUPABASE_URL`: æ‚¨çš„ Supabase é¡¹ç›® URL
- `SUPABASE_ANON_KEY`: æ‚¨çš„ Supabase anon/public key

**åœ¨ Vercel Dashboard æŸ¥æ‰¾:**
1. ç™»å½• Vercel: https://vercel.com
2. è¿›å…¥æ‚¨çš„é¡¹ç›®
3. ç‚¹å‡» **Settings** â†’ **Environment Variables**
4. æŸ¥æ‰¾ `VITE_SUPABASE_URL` å’Œ `VITE_SUPABASE_ANON_KEY`

**åœ¨ Supabase Dashboard æŸ¥æ‰¾:**
1. ç™»å½• Supabase: https://supabase.com
2. é€‰æ‹©æ‚¨çš„é¡¹ç›®
3. ç‚¹å‡» **Settings** â†’ **API**
4. å¤åˆ¶ **Project URL** å’Œ **anon/public key**

#### æ­¥éª¤ 2: è®¾ç½®ç¯å¢ƒå˜é‡

**åœ¨ Windows PowerShell:**
```powershell
$env:VITE_SUPABASE_URL="https://your-project.supabase.co"
$env:VITE_SUPABASE_ANON_KEY="your-anon-key-here"
```

**æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°:**
```powershell
# ä¸è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç›´æ¥ä¼ å‚æ•°
node scripts/supabase-mcp-import.js "https://your-project.supabase.co" "your-anon-key"
```

#### æ­¥éª¤ 3: æ‰§è¡Œå¯¼å…¥

```bash
cd C:\Users\USER\Desktop\mynook
node scripts/supabase-mcp-import.js
```

#### é¢„æœŸè¾“å‡º

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     MyNook Supabase MCP æ¨¡æ¿å¯¼å…¥ (æ–¹æ¡ˆB - ç¼–ç¨‹æ–¹å¼)       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ æ­£åœ¨ç”Ÿæˆæ¨¡æ¿æ•°æ®...
âœ… å·²ç”Ÿæˆ 31 ä¸ªæ¨¡æ¿

ğŸ“ æ­¥éª¤ 1/3: æ¸…é™¤ç°æœ‰ Interior Design æ¨¡æ¿...
âœ… æ­¥éª¤ 1 å®Œæˆ!

ğŸ“ æ­¥éª¤ 2/3: æ‰¹é‡å¯¼å…¥æ–°æ¨¡æ¿...
   æ‰¹æ¬¡ 1/4: å¯¼å…¥ 10 ä¸ªæ¨¡æ¿...
   âœ… æ‰¹æ¬¡å¯¼å…¥æˆåŠŸ (10 ä¸ªæ¨¡æ¿)
   æ‰¹æ¬¡ 2/4: å¯¼å…¥ 10 ä¸ªæ¨¡æ¿...
   âœ… æ‰¹æ¬¡å¯¼å…¥æˆåŠŸ (10 ä¸ªæ¨¡æ¿)
   ...
âœ… æ­¥éª¤ 2 å®Œæˆ!

ğŸ“ æ­¥éª¤ 3/3: éªŒè¯å¯¼å…¥ç»“æœ...
âœ… æ•°æ®åº“ä¸­å…±æœ‰ 31 ä¸ªæ¨¡æ¿

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ğŸ‰ å¯¼å…¥æˆåŠŸ! ğŸ‰                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š å¯¼å…¥ç»Ÿè®¡:
   â€¢ å‡†å¤‡å¯¼å…¥: 31 ä¸ªæ¨¡æ¿
   â€¢ æˆåŠŸå¯¼å…¥: 31 ä¸ªæ¨¡æ¿
   â€¢ å¤±è´¥: 0 ä¸ªæ¨¡æ¿
   â€¢ æ•°æ®åº“ä¸­æ€»è®¡: 31 ä¸ªæ¨¡æ¿
   â€¢ æˆåŠŸç‡: 100.0%
```

---

### æ–¹æ³• 2: ä½¿ç”¨ SQL ç›´æ¥æ‰§è¡Œ

å¦‚æœæ‚¨æ›´å–œæ¬¢ç›´æ¥æ‰§è¡Œ SQLï¼š

#### æ­¥éª¤ 1: æ‰“å¼€ Supabase SQL Editor

1. ç™»å½• Supabase Dashboard
2. é€‰æ‹©æ‚¨çš„é¡¹ç›®
3. ç‚¹å‡»å·¦ä¾§èœå•çš„ **SQL Editor**

#### æ­¥éª¤ 2: æ‰§è¡Œ SQL

1. åˆ›å»ºæ–°æŸ¥è¯¢
2. å¤åˆ¶ `scripts/import-templates.sql` çš„å†…å®¹
3. ç‚¹å‡» **Run** æ‰§è¡Œ

**æ³¨æ„:** SQL æ–‡ä»¶åŒ…å« DELETE è¯­å¥ï¼Œä¼šå…ˆæ¸…é™¤ç°æœ‰çš„ Interior Design æ¨¡æ¿ã€‚

---

## ğŸ“Š å¯¼å…¥çš„æ¨¡æ¿è¯¦æƒ…

### è®¾è®¡é£æ ¼ (10ç§)

1. **Latte / Creamy Style** - æ‹¿é“å¥¶æ²¹é£ (sort_order: 1) ğŸ”¥ğŸ”¥ğŸ”¥
2. **Dopamine Decor** - å¤šå·´èƒºè£…é¥° (sort_order: 2) ğŸ”¥ğŸ”¥ğŸ”¥
3. **Organic Modern** - æœ‰æœºç°ä»£ (sort_order: 3) ğŸ”¥ğŸ”¥ğŸ”¥
4. **Quiet Luxury** - ä½è°ƒå¥¢å (sort_order: 4) ğŸ”¥ğŸ”¥ğŸ”¥
5. **Warm Minimalism** - æ¸©æš–æç®€ (sort_order: 5) ğŸ”¥ğŸ”¥ğŸ”¥
6. **Scandinavian** - æ–¯å ªçš„çº³ç»´äºš (sort_order: 6) ğŸ”¥ğŸ”¥ğŸ”¥
7. **Maximalist** - æç¹ä¸»ä¹‰ (sort_order: 7) ğŸ”¥ğŸ”¥ğŸ”¥
8. **Japandi** - æ—¥å¼ä¾˜å¯‚ (sort_order: 8) ğŸ”¥ğŸ”¥ğŸ”¥
9. **Modern Farmhouse** - ç°ä»£å†œèˆ (sort_order: 9) ğŸ”¥ğŸ”¥ğŸ”¥
10. **Modern Minimalist** - ç°ä»£æç®€ (sort_order: 10) ğŸ”¥ğŸ”¥ğŸ”¥

### æˆ¿é—´ç±»å‹ (5ç§)

1. **Living Room** (å®¢å…) - 10 ä¸ªæ¨¡æ¿
2. **Master Bedroom** (ä¸»å§) - 6 ä¸ªæ¨¡æ¿
3. **Kitchen** (å¨æˆ¿) - 5 ä¸ªæ¨¡æ¿
4. **Bathroom** (æµ´å®¤) - 5 ä¸ªæ¨¡æ¿
5. **Home Office** (å®¶åº­åŠå…¬å®¤) - 5 ä¸ªæ¨¡æ¿

**æ€»è®¡:** 31 ä¸ªé«˜è´¨é‡æ¨¡æ¿

---

## âœ… éªŒè¯å¯¼å…¥ç»“æœ

### åœ¨ Supabase Dashboard éªŒè¯

1. ç™»å½• Supabase Dashboard
2. è¿›å…¥ **Table Editor**
3. é€‰æ‹© `design_templates` è¡¨
4. ç­›é€‰: `main_category = 'Interior Design'`
5. æ£€æŸ¥:
   - âœ… å…±æœ‰ 31 æ¡è®°å½•
   - âœ… æ‰€æœ‰æ¨¡æ¿ `enabled = true`
   - âœ… æ‰€æœ‰æ¨¡æ¿æœ‰ `room_type` å€¼
   - âœ… `sort_order` æ­£ç¡® (1-10)

### åœ¨åº”ç”¨ä¸­éªŒè¯

1. è®¿é—®æ‚¨çš„åº”ç”¨ (Vercel éƒ¨ç½²)
2. è¿›å…¥ **Admin Panel**
3. æŸ¥çœ‹ **Template Management**
4. ç¡®è®¤:
   - âœ… Interior Design åˆ†ç±»æ˜¾ç¤ºæ­£å¸¸
   - âœ… æŒ‰æˆ¿é—´ç±»å‹åˆ†ç»„æ˜¾ç¤º
   - âœ… æ¨¡æ¿æŒ‰ sort_order æ’åº

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: "ç¼ºå°‘ Supabase å‡­è¯"

**ç—‡çŠ¶:**
```
âŒ ç¼ºå°‘ Supabase å‡­è¯ï¼
```

**è§£å†³æ–¹æ¡ˆ:**
- ç¡®ä¿è®¾ç½®äº†ç¯å¢ƒå˜é‡æˆ–ä¼ é€’äº†å‘½ä»¤è¡Œå‚æ•°
- æ£€æŸ¥ URL å’Œ Key æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯

### é—®é¢˜ 2: "Unauthorized" æˆ– "Permission denied"

**ç—‡çŠ¶:**
```
âŒ Error: You do not have permission
```

**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥ RLS (Row Level Security) ç­–ç•¥
- ç¡®ä¿ä½¿ç”¨çš„æ˜¯ `anon` keyï¼ˆä¸æ˜¯ service_role keyï¼‰
- éªŒè¯æ‚¨çš„ç”¨æˆ·è´¦å·æœ‰ admin æƒé™

### é—®é¢˜ 3: "Batch failed" æ‰¹é‡å¯¼å…¥å¤±è´¥

**ç—‡çŠ¶:**
```
âŒ æ‰¹æ¬¡å¤±è´¥: duplicate key value
```

**è§£å†³æ–¹æ¡ˆ:**
- æ•°æ®åº“ä¸­å¯èƒ½å·²æœ‰ç›¸åŒåç§°çš„æ¨¡æ¿
- æ‰‹åŠ¨åˆ é™¤ç°æœ‰ Interior Design æ¨¡æ¿
- æˆ–ä¿®æ”¹è„šæœ¬ä¸­çš„æ¨¡æ¿åç§°ä½¿å…¶å”¯ä¸€

### é—®é¢˜ 4: ç½‘ç»œè¶…æ—¶

**ç—‡çŠ¶:**
```
âŒ Error: fetch failed / timeout
```

**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥ Supabase é¡¹ç›®æ˜¯å¦è¿è¡Œæ­£å¸¸
- å¢åŠ æ‰¹æ¬¡ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´

---

## ğŸ“ ä¸‹ä¸€æ­¥

å¯¼å…¥æˆåŠŸåï¼š

### 1. ç”Ÿæˆ CSV è·Ÿè¸ªæ–‡ä»¶

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå›¾ç‰‡è·Ÿè¸ª CSVï¼š
```bash
node scripts/generate-csv-tracker.js
```

è¿™å°†åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š
- `templates-image-mapping.csv` - å®Œæ•´è¯¦æƒ…
- `templates-image-mapping-simple.csv` - å¿«é€Ÿå‚è€ƒ

### 2. ç”Ÿæˆå›¾ç‰‡

ä½¿ç”¨ CSV æ–‡ä»¶ä¸­çš„ promptsï¼š
1. æ‰“å¼€ `templates-image-mapping-simple.csv`
2. æŒ‰ä¼˜å…ˆçº§æ’åº (sort_order 1-10)
3. ä½¿ç”¨ Vertex AI æˆ–å…¶ä»–å·¥å…·ç”Ÿæˆå›¾ç‰‡
4. æŒ‰ç…§ naming convention ä¿å­˜å›¾ç‰‡

è¯¦è§: `IMAGE_UPLOAD_GUIDE.md`

### 3. æ›´æ–°å›¾ç‰‡ URL

ç”Ÿæˆå›¾ç‰‡åï¼š
1. ä¸Šä¼ åˆ° Google Cloud Storage
2. è·å–å…¬å¼€ URL
3. åœ¨ CSV ä¸­æ›´æ–° URL
4. (æœªæ¥) è¿è¡Œæ‰¹é‡æ›´æ–°è„šæœ¬

---

## ğŸ‰ å®Œæˆæ ‡å‡†

- [x] è„šæœ¬å·²åˆ›å»º
- [x] SQL æ–‡ä»¶å·²ç”Ÿæˆ
- [x] æ–‡æ¡£å·²å®Œæˆ
- [ ] **å¾…æ‰§è¡Œ:** è¿è¡Œå¯¼å…¥è„šæœ¬
- [ ] **å¾…éªŒè¯:** æ£€æŸ¥æ•°æ®åº“
- [ ] **å¾…ç”Ÿæˆ:** CSV è·Ÿè¸ªæ–‡ä»¶

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. `TEMPLATE_SYSTEM_OVERHAUL_REPORT.md` - ç³»ç»Ÿæ¦‚è¿°
2. `TEMPLATE_OVERHAUL_COMPLETE.md` - å®Œæ•´æ–‡æ¡£
3. `scripts/README.md` - è„šæœ¬è¯´æ˜

---

**æ–‡æ¡£ç‰ˆæœ¬:** 1.0  
**æœ€åæ›´æ–°:** 2025-10-12  
**çŠ¶æ€:** âœ… å°±ç»ªæ‰§è¡Œ

